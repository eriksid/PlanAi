Plano: Migração para Arquitetura Hexagonal                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                         
 Visão Geral                                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                         
 Migrar o eventostec-backend de arquitetura em camadas tradicional para arquitetura hexagonal (ports & adapters) usando estratégia incremental. A migração será feita em fases, começando pelo agregado Event (mais complexo) e depois Coupon, mantendo o sistema        
 funcionando durante todo o processo.                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                         
 Decisões Arquiteturais                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                         
 1. Estratégia de Migração: Incremental (Strangler Fig Pattern)                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                         
 - Migrar um agregado por vez                                                                                                                                                                                                                                            
 - Manter código antigo e novo funcionando em paralelo                                                                                                                                                                                                                   
 - Validar cada fase antes de prosseguir                                                                                                                                                                                                                                 
 - Duração estimada: 3-4 semanas                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                         
 2. Address: Converter para Value Object                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                         
 - Address não tem identidade fora do contexto de Event                                                                                                                                                                                                                  
 - Será incorporado (embedded) na tabela Event                                                                                                                                                                                                                           
 - Requer migração de banco de dados em zero-downtime                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                         
 3. Separação Domain/JPA: Completa                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                         
 - Domain Models puros (POJOs, sem anotações JPA)                                                                                                                                                                                                                        
 - JPA Entities separados no adapter layer                                                                                                                                                                                                                               
 - Mappers (MapStruct) entre Domain ↔ JPA                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                         
 4. Agregados: Event e Coupon separados                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                         
 - Event é agregado raiz com Location (Value Object)                                                                                                                                                                                                                     
 - Coupon é agregado separado, referencia EventId apenas                                                                                                                                                                                                                 
 - CouponService usa EventExistencePort para validar Event                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                         
 Nova Estrutura de Pacotes                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                         
 src/main/java/com/eventostec/api/                                                                                                                                                                                                                                       
 ├── event/                          # Bounded Context: Event                                                                                                                                                                                                            
 │   ├── domain/                                                                                                                                                                                                                                                         
 │   │   ├── model/                                                                                                                                                                                                                                                      
 │   │   │   ├── Event.java         # Agregado raiz (POJO puro)                                                                                                                                                                                                          
 │   │   │   ├── Location.java      # Value Object (city + uf)                                                                                                                                                                                                           
 │   │   │   └── EventId.java       # Value Object (UUID wrapper)                                                                                                                                                                                                        
 │   │   └── exception/                                                                                                                                                                                                                                                  
 │   │       ├── EventNotFoundException.java                                                                                                                                                                                                                             
 │   │       └── InvalidEventException.java                                                                                                                                                                                                                              
 │   ├── application/                                                                                                                                                                                                                                                    
 │   │   ├── port/                                                                                                                                                                                                                                                       
 │   │   │   ├── in/                # Use Cases (inbound ports)                                                                                                                                                                                                          
 │   │   │   │   ├── CreateEventUseCase.java                                                                                                                                                                                                                             
 │   │   │   │   ├── GetEventDetailsUseCase.java                                                                                                                                                                                                                         
 │   │   │   │   ├── GetUpcomingEventsUseCase.java                                                                                                                                                                                                                       
 │   │   │   │   ├── FilterEventsUseCase.java                                                                                                                                                                                                                            
 │   │   │   │   ├── SearchEventsUseCase.java                                                                                                                                                                                                                            
 │   │   │   │   └── DeleteEventUseCase.java                                                                                                                                                                                                                             
 │   │   │   └── out/               # Outbound ports                                                                                                                                                                                                                     
 │   │   │       ├── EventRepository.java                                                                                                                                                                                                                                
 │   │   │       └── ImageStoragePort.java                                                                                                                                                                                                                               
 │   │   ├── service/                                                                                                                                                                                                                                                    
 │   │   │   └── EventApplicationService.java                                                                                                                                                                                                                            
 │   │   └── dto/                                                                                                                                                                                                                                                        
 │   │       ├── CreateEventCommand.java                                                                                                                                                                                                                                 
 │   │       ├── EventQueryResult.java                                                                                                                                                                                                                                   
 │   │       ├── EventDetailsResponse.java                                                                                                                                                                                                                               
 │   │       └── EventFilterCriteria.java                                                                                                                                                                                                                                
 │   └── adapter/                                                                                                                                                                                                                                                        
 │       ├── in/                                                                                                                                                                                                                                                         
 │       │   └── rest/                                                                                                                                                                                                                                                   
 │       │       ├── EventRestController.java                                                                                                                                                                                                                            
 │       │       ├── EventRequestMapper.java                                                                                                                                                                                                                             
 │       │       └── dto/                                                                                                                                                                                                                                                
 │       │           ├── EventRequestDTO.java                                                                                                                                                                                                                            
 │       │           └── EventResponseDTO.java                                                                                                                                                                                                                           
 │       ├── out/                                                                                                                                                                                                                                                        
 │       │   ├── persistence/                                                                                                                                                                                                                                            
 │       │   │   ├── EventJpaAdapter.java                                                                                                                                                                                                                                
 │       │   │   ├── EventJpaEntity.java                                                                                                                                                                                                                                 
 │       │   │   ├── EventJpaMapper.java                                                                                                                                                                                                                                 
 │       │   │   └── SpringDataEventRepository.java                                                                                                                                                                                                                      
 │       │   └── storage/                                                                                                                                                                                                                                                
 │       │       ├── S3ImageStorageAdapter.java                                                                                                                                                                                                                          
 │       │       └── S3Config.java                                                                                                                                                                                                                                       
 │       └── config/                                                                                                                                                                                                                                                     
 │           └── EventBeanConfiguration.java                                                                                                                                                                                                                             
 │                                                                                                                                                                                                                                                                       
 ├── coupon/                         # Bounded Context: Coupon                                                                                                                                                                                                           
 │   ├── domain/                                                                                                                                                                                                                                                         
 │   │   └── model/                                                                                                                                                                                                                                                      
 │   │       ├── Coupon.java        # Agregado raiz                                                                                                                                                                                                                      
 │   │       ├── CouponId.java                                                                                                                                                                                                                                           
 │   │       ├── CouponCode.java    # Value Object                                                                                                                                                                                                                       
 │   │       └── Discount.java      # Value Object                                                                                                                                                                                                                       
 │   ├── application/                                                                                                                                                                                                                                                    
 │   │   ├── port/                                                                                                                                                                                                                                                       
 │   │   │   ├── in/                                                                                                                                                                                                                                                     
 │   │   │   │   ├── AddCouponUseCase.java                                                                                                                                                                                                                               
 │   │   │   │   └── GetValidCouponsUseCase.java                                                                                                                                                                                                                         
 │   │   │   └── out/                                                                                                                                                                                                                                                    
 │   │   │       ├── CouponRepository.java                                                                                                                                                                                                                               
 │   │   │       └── EventExistencePort.java                                                                                                                                                                                                                             
 │   │   ├── service/                                                                                                                                                                                                                                                    
 │   │   │   └── CouponApplicationService.java                                                                                                                                                                                                                           
 │   │   └── dto/                                                                                                                                                                                                                                                        
 │   │       ├── AddCouponCommand.java                                                                                                                                                                                                                                   
 │   │       └── CouponQueryResult.java                                                                                                                                                                                                                                  
 │   └── adapter/                                                                                                                                                                                                                                                        
 │       ├── in/                                                                                                                                                                                                                                                         
 │       │   └── rest/                                                                                                                                                                                                                                                   
 │       │       └── CouponRestController.java                                                                                                                                                                                                                           
 │       ├── out/                                                                                                                                                                                                                                                        
 │       │   ├── persistence/                                                                                                                                                                                                                                            
 │       │   │   ├── CouponJpaAdapter.java                                                                                                                                                                                                                               
 │       │   │   ├── CouponJpaEntity.java                                                                                                                                                                                                                                
 │       │   │   └── SpringDataCouponRepository.java                                                                                                                                                                                                                     
 │       │   └── event/                                                                                                                                                                                                                                                  
 │       │       └── EventExistenceAdapter.java                                                                                                                                                                                                                          
 │       └── config/                                                                                                                                                                                                                                                     
 │           └── CouponBeanConfiguration.java                                                                                                                                                                                                                            
 │                                                                                                                                                                                                                                                                       
 └── shared/                         # Shared Kernel                                                                                                                                                                                                                     
     ├── domain/                                                                                                                                                                                                                                                         
     │   └── valueobject/                                                                                                                                                                                                                                                
     │       └── EventId.java       # Compartilhado entre contexts                                                                                                                                                                                                       
     ├── exception/                                                                                                                                                                                                                                                      
     │   ├── DomainException.java                                                                                                                                                                                                                                        
     │   └── BusinessRuleViolationException.java                                                                                                                                                                                                                         
     └── adapter/                                                                                                                                                                                                                                                        
         └── web/                                                                                                                                                                                                                                                        
             ├── GlobalExceptionHandler.java                                                                                                                                                                                                                             
             ├── ProblemDetails.java                                                                                                                                                                                                                                     
             └── CorsConfig.java                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                         
 Fases da Migração                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                         
 FASE 1: Estrutura Base (Dias 1-2)                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                         
 Objetivo: Criar estrutura hexagonal sem quebrar código existente                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                         
 Tarefas:                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                         
 1. Criar nova estrutura de pacotes                                                                                                                                                                                                                                      
   - Criar todos os diretórios conforme estrutura acima                                                                                                                                                                                                                  
   - Manter código atual intacto                                                                                                                                                                                                                                         
 2. Criar Shared Kernel                                                                                                                                                                                                                                                  
   - shared/domain/valueobject/EventId.java - Value Object para UUID                                                                                                                                                                                                     
   - shared/exception/DomainException.java - Exceção base                                                                                                                                                                                                                
   - Mover exceptions/config/ApiExceptionHandler.java → shared/adapter/web/GlobalExceptionHandler.java                                                                                                                                                                   
   - Mover exceptions/config/ProblemDetails.java → shared/adapter/web/ProblemDetails.java                                                                                                                                                                                
   - Mover config/CorsConfig.java → shared/adapter/web/CorsConfig.java                                                                                                                                                                                                   
 3. Configurar ArchUnit para validar regras                                                                                                                                                                                                                              
   - Adicionar dependência ArchUnit no pom.xml                                                                                                                                                                                                                           
   - Criar teste que valida:                                                                                                                                                                                                                                             
       - Domain não depende de application/adapter                                                                                                                                                                                                                       
     - Application não depende de adapter                                                                                                                                                                                                                                
     - Adapters podem depender de tudo                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                         
 Arquivos a criar:                                                                                                                                                                                                                                                       
 - shared/domain/valueobject/EventId.java                                                                                                                                                                                                                                
 - shared/exception/DomainException.java                                                                                                                                                                                                                                 
 - shared/exception/BusinessRuleViolationException.java                                                                                                                                                                                                                  
 - src/test/java/com/eventostec/api/ArchitectureTest.java                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                         
 Verificação:                                                                                                                                                                                                                                                            
 - Todos os testes existentes ainda passam                                                                                                                                                                                                                               
 - ArchUnit tests validam estrutura                                                                                                                                                                                                                                      
 - Build Maven bem-sucedido                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                         
 ---                                                                                                                                                                                                                                                                     
 FASE 2: Migrar Event Aggregate (Dias 3-10)                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                         
 Objetivo: Migrar completamente o agregado Event para arquitetura hexagonal                                                                                                                                                                                              
                                                                                                                                                                                                                                                                         
 Passo 2.1: Domain Layer (Dia 3)                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                         
 Criar Domain Model puro:                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                         
 1. event/domain/model/Event.java                                                                                                                                                                                                                                        
   - POJO puro, sem anotações JPA                                                                                                                                                                                                                                        
   - Campos: EventId, title, description, date, Location, imageUrl, eventUrl, remote                                                                                                                                                                                     
   - Métodos de negócio:                                                                                                                                                                                                                                                 
   public static Event create(Title title, Description description, ...)                                                                                                                                                                                                 
 public void updateLocation(Location location)                                                                                                                                                                                                                           
 public void markAsRemote()                                                                                                                                                                                                                                              
 public boolean isUpcoming()                                                                                                                                                                                                                                             
   - Validações no construtor                                                                                                                                                                                                                                            
 2. event/domain/model/Location.java (Value Object)                                                                                                                                                                                                                      
   - Campos: city, uf                                                                                                                                                                                                                                                    
   - Imutável                                                                                                                                                                                                                                                            
   - Validação: não pode ser null se event.remote = false                                                                                                                                                                                                                
 3. event/domain/model/EventId.java                                                                                                                                                                                                                                      
   - Wrapper para UUID                                                                                                                                                                                                                                                   
   - Métodos: newId(), of(UUID), asString()                                                                                                                                                                                                                              
 4. event/domain/exception/EventNotFoundException.java                                                                                                                                                                                                                   
 5. event/domain/exception/InvalidEventException.java                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                         
 Arquivos base:                                                                                                                                                                                                                                                          
 - Copiar lógica de domain/event/Event.java (remover JPA)                                                                                                                                                                                                                
 - Copiar validações de domain/event/EventRequestDTO.java                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                         
 Testes:                                                                                                                                                                                                                                                                 
 - Unit tests para Event domain (sem Spring)                                                                                                                                                                                                                             
 - Testar regras de negócio isoladamente                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                         
 Passo 2.2: Application Layer - Ports (Dia 4)                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                         
 Criar interfaces de portas:                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                         
 1. Inbound Ports (Use Cases):                                                                                                                                                                                                                                           
   - application/port/in/CreateEventUseCase.java                                                                                                                                                                                                                         
   - application/port/in/GetEventDetailsUseCase.java                                                                                                                                                                                                                     
   - application/port/in/GetUpcomingEventsUseCase.java                                                                                                                                                                                                                   
   - application/port/in/FilterEventsUseCase.java                                                                                                                                                                                                                        
   - application/port/in/SearchEventsUseCase.java                                                                                                                                                                                                                        
   - application/port/in/DeleteEventUseCase.java                                                                                                                                                                                                                         
 2. Outbound Ports:                                                                                                                                                                                                                                                      
   - application/port/out/EventRepository.java (não é Spring Data!)                                                                                                                                                                                                      
   - application/port/out/ImageStoragePort.java                                                                                                                                                                                                                          
 3. DTOs de Aplicação:                                                                                                                                                                                                                                                   
   - application/dto/CreateEventCommand.java (input)                                                                                                                                                                                                                     
   - application/dto/EventQueryResult.java (output)                                                                                                                                                                                                                      
   - application/dto/EventDetailsResponse.java                                                                                                                                                                                                                           
   - application/dto/EventFilterCriteria.java                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                         
 Referência:                                                                                                                                                                                                                                                             
 - Analisar métodos de service/EventService.java para definir assinaturas                                                                                                                                                                                                
                                                                                                                                                                                                                                                                         
 Passo 2.3: Application Layer - Service (Dia 5)                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                         
 Criar implementação:                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                         
 1. application/service/EventApplicationService.java                                                                                                                                                                                                                     
   - Implementa todos os Use Cases (CreateEventUseCase, GetEventDetailsUseCase, etc)                                                                                                                                                                                     
   - Injeta ports (EventRepository, ImageStoragePort)                                                                                                                                                                                                                    
   - Orquestra lógica de negócio                                                                                                                                                                                                                                         
   - Anota com @Service e @Transactional                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                         
 Exemplo:                                                                                                                                                                                                                                                                
 @Service                                                                                                                                                                                                                                                                
 @Transactional                                                                                                                                                                                                                                                          
 @RequiredArgsConstructor                                                                                                                                                                                                                                                
 public class EventApplicationService implements CreateEventUseCase, GetEventDetailsUseCase {                                                                                                                                                                            
                                                                                                                                                                                                                                                                         
     private final EventRepository eventRepository;                                                                                                                                                                                                                      
     private final ImageStoragePort imageStoragePort;                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                         
     @Override                                                                                                                                                                                                                                                           
     public EventId createEvent(CreateEventCommand command) {                                                                                                                                                                                                            
         // 1. Upload image se presente                                                                                                                                                                                                                                  
         ImageUrl imageUrl = command.image() != null                                                                                                                                                                                                                     
             ? imageStoragePort.uploadImage(command.image())                                                                                                                                                                                                             
             : ImageUrl.empty();                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                         
         // 2. Criar domain model                                                                                                                                                                                                                                        
         Event event = Event.create(                                                                                                                                                                                                                                     
             new Title(command.title()),                                                                                                                                                                                                                                 
             new Description(command.description()),                                                                                                                                                                                                                     
             new EventDate(command.date()),                                                                                                                                                                                                                              
             command.remote() ? null : new Location(command.city(), command.uf()),                                                                                                                                                                                       
             imageUrl,                                                                                                                                                                                                                                                   
             new EventUrl(command.eventUrl()),                                                                                                                                                                                                                           
             command.remote()                                                                                                                                                                                                                                            
         );                                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                         
         // 3. Persistir via port                                                                                                                                                                                                                                        
         return eventRepository.save(event);                                                                                                                                                                                                                             
     }                                                                                                                                                                                                                                                                   
 }                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                         
 Mover lógica de:                                                                                                                                                                                                                                                        
 - service/EventService.java → EventApplicationService                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                         
 Testes:                                                                                                                                                                                                                                                                 
 - Unit tests com mocks para ports                                                                                                                                                                                                                                       
 - Verificar orquestração correta                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                         
 Passo 2.4: Adapter - Persistence (Dias 6-7)                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                         
 Criar adapter JPA:                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                         
 1. adapter/out/persistence/EventJpaEntity.java                                                                                                                                                                                                                          
   - Classe com anotações JPA (@Entity, @Table, @Id, etc)                                                                                                                                                                                                                
   - Campos mapeados para banco                                                                                                                                                                                                                                          
   - Address embedded (@Embedded ou colunas diretas)                                                                                                                                                                                                                     
 2. adapter/out/persistence/SpringDataEventRepository.java                                                                                                                                                                                                               
   - Interface Spring Data JPA                                                                                                                                                                                                                                           
   - Copiar queries customizadas de repositories/EventRepository.java                                                                                                                                                                                                    
   - Manter projeção EventAddressProjection                                                                                                                                                                                                                              
 3. adapter/out/persistence/EventJpaMapper.java                                                                                                                                                                                                                          
   - Interface MapStruct                                                                                                                                                                                                                                                 
   - Métodos: Event toDomain(EventJpaEntity) e EventJpaEntity toJpa(Event)                                                                                                                                                                                               
   - Mapear Location ↔ city/uf embedded                                                                                                                                                                                                                                  
 4. adapter/out/persistence/EventJpaAdapter.java                                                                                                                                                                                                                         
   - Implementa application/port/out/EventRepository.java (port)                                                                                                                                                                                                         
   - Usa SpringDataEventRepository + EventJpaMapper                                                                                                                                                                                                                      
   - Traduz entre domain model e JPA entity                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                         
 Exemplo EventJpaAdapter:                                                                                                                                                                                                                                                
 @Component                                                                                                                                                                                                                                                              
 @RequiredArgsConstructor                                                                                                                                                                                                                                                
 public class EventJpaAdapter implements EventRepository {                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                         
     private final SpringDataEventRepository springRepo;                                                                                                                                                                                                                 
     private final EventJpaMapper mapper;                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                         
     @Override                                                                                                                                                                                                                                                           
     public EventId save(Event event) {                                                                                                                                                                                                                                  
         EventJpaEntity jpaEntity = mapper.toJpa(event);                                                                                                                                                                                                                 
         EventJpaEntity saved = springRepo.save(jpaEntity);                                                                                                                                                                                                              
         return new EventId(saved.getId());                                                                                                                                                                                                                              
     }                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                         
     @Override                                                                                                                                                                                                                                                           
     public Optional<Event> findById(EventId eventId) {                                                                                                                                                                                                                  
         return springRepo.findById(eventId.getValue())                                                                                                                                                                                                                  
             .map(mapper::toDomain);                                                                                                                                                                                                                                     
     }                                                                                                                                                                                                                                                                   
 }                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                         
 Testes:                                                                                                                                                                                                                                                                 
 - Integration tests com H2                                                                                                                                                                                                                                              
 - Testar mapeamento Domain ↔ JPA                                                                                                                                                                                                                                        
 - Testar queries customizadas                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                         
 Passo 2.5: Adapter - Storage (Dia 7)                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                         
 Criar adapter S3:                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                         
 1. adapter/out/storage/S3ImageStorageAdapter.java                                                                                                                                                                                                                       
   - Implementa application/port/out/ImageStoragePort                                                                                                                                                                                                                    
   - Copiar lógica de upload de service/EventService.uploadImg()                                                                                                                                                                                                         
   - Usa S3Client                                                                                                                                                                                                                                                        
 2. adapter/out/storage/S3Config.java                                                                                                                                                                                                                                    
   - Mover de config/AWSConfig.java                                                                                                                                                                                                                                      
   - Bean S3Client                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                         
 Testes:                                                                                                                                                                                                                                                                 
 - Mock S3Client ou usar LocalStack                                                                                                                                                                                                                                      
 - Testar upload e geração de URL                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                         
 Passo 2.6: Adapter - REST (Dia 8)                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                         
 Criar adapter REST:                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                         
 1. adapter/in/rest/EventRestController.java                                                                                                                                                                                                                             
   - Endpoints REST (copiar de controller/EventController.java)                                                                                                                                                                                                          
   - Injeta Use Cases (não service)                                                                                                                                                                                                                                      
   - Usa EventRequestMapper para conversões                                                                                                                                                                                                                              
 2. adapter/in/rest/dto/EventRequestDTO.java                                                                                                                                                                                                                             
   - Mover de domain/event/EventRequestDTO.java                                                                                                                                                                                                                          
   - DTO específico para REST (multipart)                                                                                                                                                                                                                                
 3. adapter/in/rest/dto/EventResponseDTO.java                                                                                                                                                                                                                            
   - Mover de domain/event/EventResponseDTO.java                                                                                                                                                                                                                         
 4. adapter/in/rest/EventRequestMapper.java                                                                                                                                                                                                                              
   - MapStruct interface                                                                                                                                                                                                                                                 
   - EventRequestDTO → CreateEventCommand                                                                                                                                                                                                                                
   - EventQueryResult → EventResponseDTO                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                         
 Exemplo Controller:                                                                                                                                                                                                                                                     
 @RestController                                                                                                                                                                                                                                                         
 @RequiredArgsConstructor                                                                                                                                                                                                                                                
 @RequestMapping("/api/event")                                                                                                                                                                                                                                           
 public class EventRestController {                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                         
     private final CreateEventUseCase createEventUseCase;                                                                                                                                                                                                                
     private final GetEventDetailsUseCase getEventDetailsUseCase;                                                                                                                                                                                                        
     private final EventRequestMapper mapper;                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                         
     @PostMapping(consumes = "multipart/form-data")                                                                                                                                                                                                                      
     public ResponseEntity<UUID> create(@Valid @ModelAttribute EventRequestDTO dto) {                                                                                                                                                                                    
         CreateEventCommand command = mapper.toCommand(dto);                                                                                                                                                                                                             
         EventId eventId = createEventUseCase.createEvent(command);                                                                                                                                                                                                      
         return ResponseEntity.ok(eventId.getValue());                                                                                                                                                                                                                   
     }                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                         
     @GetMapping("/{eventId}")                                                                                                                                                                                                                                           
     public ResponseEntity<EventDetailsResponse> getDetails(@PathVariable UUID eventId) {                                                                                                                                                                                
         EventDetailsResponse response = getEventDetailsUseCase.getEventDetails(new EventId(eventId));                                                                                                                                                                   
         return ResponseEntity.ok(response);                                                                                                                                                                                                                             
     }                                                                                                                                                                                                                                                                   
 }                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                         
 Testes:                                                                                                                                                                                                                                                                 
 - Integration tests com MockMvc                                                                                                                                                                                                                                         
 - Testar validações                                                                                                                                                                                                                                                     
 - Testar mapeamentos                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                         
 Passo 2.7: Wiring (Dia 9)                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                         
 Configurar Spring:                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                         
 1. adapter/config/EventBeanConfiguration.java                                                                                                                                                                                                                           
   - @Configuration                                                                                                                                                                                                                                                      
   - Criar beans para use cases                                                                                                                                                                                                                                          
   - Conectar ports a adapters                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                         
 Exemplo:                                                                                                                                                                                                                                                                
 @Configuration                                                                                                                                                                                                                                                          
 public class EventBeanConfiguration {                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                         
     @Bean                                                                                                                                                                                                                                                               
     public EventRepository eventRepository(                                                                                                                                                                                                                             
         SpringDataEventRepository springRepo,                                                                                                                                                                                                                           
         EventJpaMapper mapper) {                                                                                                                                                                                                                                        
         return new EventJpaAdapter(springRepo, mapper);                                                                                                                                                                                                                 
     }                                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                         
     @Bean                                                                                                                                                                                                                                                               
     public ImageStoragePort imageStoragePort(S3Client s3Client,                                                                                                                                                                                                         
                                              @Value("${aws.bucket.name}") String bucketName) {                                                                                                                                                                          
         return new S3ImageStorageAdapter(s3Client, bucketName);                                                                                                                                                                                                         
     }                                                                                                                                                                                                                                                                   
 }                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                         
 Verificação:                                                                                                                                                                                                                                                            
 - Aplicação sobe sem erros                                                                                                                                                                                                                                              
 - Todos os beans são criados                                                                                                                                                                                                                                            
 - Testes de integração passam                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                         
 Passo 2.8: Testes Paralelos (Dia 10)                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                         
 Validar equivalência:                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                         
 1. Manter controller/EventController.java (antigo) ativo                                                                                                                                                                                                                
 2. Ativar adapter/in/rest/EventRestController.java em endpoint diferente (ex: /api/v2/event)                                                                                                                                                                            
 3. Criar testes que chamam ambos endpoints e comparam respostas                                                                                                                                                                                                         
 4. Validar comportamento idêntico                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                         
 Verificação:                                                                                                                                                                                                                                                            
 - 100% compatibilidade entre old/new                                                                                                                                                                                                                                    
 - Performance similar (máx 5% overhead)                                                                                                                                                                                                                                 
 - Todos os testes passam                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                         
 ---                                                                                                                                                                                                                                                                     
 FASE 3: Migração de Banco (Address → Value Object) (Dia 11)                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                         
 Objetivo: Migrar Address de tabela separada para colunas embedded em Event                                                                                                                                                                                              
                                                                                                                                                                                                                                                                         
 Estratégia Zero-Downtime:                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                                         
 Passo 3.1: Adicionar colunas na tabela Event                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                         
 Criar migração V7:                                                                                                                                                                                                                                                      
 -- V7__add_location_columns_to_event.sql                                                                                                                                                                                                                                
 ALTER TABLE event ADD COLUMN city VARCHAR(255);                                                                                                                                                                                                                         
 ALTER TABLE event ADD COLUMN uf VARCHAR(2);                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                         
 Executar:                                                                                                                                                                                                                                                               
 - Deploy com migração V7                                                                                                                                                                                                                                                
 - Colunas criadas mas ainda NULL                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                         
 Passo 3.2: Backfill de dados                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                         
 Criar migração V8:                                                                                                                                                                                                                                                      
 -- V8__backfill_address_to_event.sql                                                                                                                                                                                                                                    
 UPDATE event e                                                                                                                                                                                                                                                          
 SET city = a.city, uf = a.uf                                                                                                                                                                                                                                            
 FROM address a                                                                                                                                                                                                                                                          
 WHERE a.event_id = e.id;                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                         
 Executar:                                                                                                                                                                                                                                                               
 - Dados copiados de address → event                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                         
 Passo 3.3: Atualizar JpaEntity                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                                         
 Modificar EventJpaEntity.java:                                                                                                                                                                                                                                          
 @Entity                                                                                                                                                                                                                                                                 
 @Table(name = "event")                                                                                                                                                                                                                                                  
 public class EventJpaEntity {                                                                                                                                                                                                                                           
     // ... outros campos                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                         
     @Column(name = "city")                                                                                                                                                                                                                                              
     private String city;                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                         
     @Column(name = "uf")                                                                                                                                                                                                                                                
     private String uf;                                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                         
     // Remover relacionamento @OneToOne com Address                                                                                                                                                                                                                     
 }                                                                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                                         
 Deploy:                                                                                                                                                                                                                                                                 
 - Aplicação passa a usar novas colunas                                                                                                                                                                                                                                  
 - Tabela address ainda existe (não é lida)                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                         
 Passo 3.4: Drop tabela address (após validação)                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                         
 Criar migração V9 (executar após 1 semana de validação):                                                                                                                                                                                                                
 -- V9__drop_address_table.sql                                                                                                                                                                                                                                           
 DROP TABLE address;                                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                                         
 Remover:                                                                                                                                                                                                                                                                
 - domain/address/Address.java                                                                                                                                                                                                                                           
 - service/AddressService.java                                                                                                                                                                                                                                           
 - repositories/AddressRepository.java                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                         
 Verificação:                                                                                                                                                                                                                                                            
 - Nenhum erro em produção                                                                                                                                                                                                                                               
 - Dados corretos nas novas colunas                                                                                                                                                                                                                                      
 - Rollback plan preparado (recriar tabela address)                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                         
 ---                                                                                                                                                                                                                                                                     
 FASE 4: Migrar Coupon Aggregate (Dias 12-16)                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                         
 Objetivo: Migrar Coupon seguindo mesmo padrão de Event                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                         
 Passos (similares à Fase 2):                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                                         
 1. Domain Layer (Dia 12)                                                                                                                                                                                                                                                
   - coupon/domain/model/Coupon.java (POJO puro)                                                                                                                                                                                                                         
   - coupon/domain/model/CouponId.java                                                                                                                                                                                                                                   
   - coupon/domain/model/CouponCode.java (Value Object)                                                                                                                                                                                                                  
   - coupon/domain/model/Discount.java (Value Object com validação 0-100)                                                                                                                                                                                                
 2. Application Layer (Dia 13)                                                                                                                                                                                                                                           
   - Ports: AddCouponUseCase, GetValidCouponsUseCase                                                                                                                                                                                                                     
   - Port out: CouponRepository, EventExistencePort                                                                                                                                                                                                                      
   - Service: CouponApplicationService                                                                                                                                                                                                                                   
   - DTOs: AddCouponCommand, CouponQueryResult                                                                                                                                                                                                                           
 3. Adapters (Dias 14-15)                                                                                                                                                                                                                                                
   - Persistence: CouponJpaAdapter, CouponJpaEntity, SpringDataCouponRepository                                                                                                                                                                                          
   - Event Existence: EventExistenceAdapter (implementa EventExistencePort, usa EventRepository)                                                                                                                                                                         
   - REST: CouponRestController                                                                                                                                                                                                                                          
 4. Wiring (Dia 15)                                                                                                                                                                                                                                                      
   - CouponBeanConfiguration.java                                                                                                                                                                                                                                        
 5. Testes Paralelos (Dia 16)                                                                                                                                                                                                                                            
   - Validar equivalência com código antigo                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                         
 Ponto de atenção:                                                                                                                                                                                                                                                       
 - EventExistenceAdapter (em coupon/adapter/out/event/) consulta Event repository                                                                                                                                                                                        
 - Coupon não tem acesso direto ao agregado Event, apenas verifica existência                                                                                                                                                                                            
                                                                                                                                                                                                                                                                         
 Verificação:                                                                                                                                                                                                                                                            
 - Coupons criados corretamente                                                                                                                                                                                                                                          
 - Validação de Event existence funciona                                                                                                                                                                                                                                 
 - Queries de coupons válidos funcionam                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                         
 ---                                                                                                                                                                                                                                                                     
 FASE 5: Cleanup e Cutover (Dias 17-18)                                                                                                                                                                                                                                  
                                                                                                                                                                                                                                                                         
 Objetivo: Remover código legado                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                         
 Tarefas:                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                         
 1. Redirecionar tráfego                                                                                                                                                                                                                                                 
   - Atualizar EventRestController para /api/event (remover v2)                                                                                                                                                                                                          
   - Remover feature flags                                                                                                                                                                                                                                               
 2. Deletar código antigo:                                                                                                                                                                                                                                               
   - controller/EventController.java (antigo)                                                                                                                                                                                                                            
   - controller/CouponController.java (antigo)                                                                                                                                                                                                                           
   - service/EventService.java                                                                                                                                                                                                                                           
   - service/CouponService.java                                                                                                                                                                                                                                          
   - service/AddressService.java                                                                                                                                                                                                                                         
   - domain/event/Event.java (JPA anotado)                                                                                                                                                                                                                               
   - domain/coupon/Coupon.java (JPA anotado)                                                                                                                                                                                                                             
   - domain/address/Address.java                                                                                                                                                                                                                                         
   - domain/event/EventRequestDTO.java                                                                                                                                                                                                                                   
   - domain/event/EventResponseDTO.java                                                                                                                                                                                                                                  
   - domain/event/EventDetailsDTO.java                                                                                                                                                                                                                                   
   - domain/coupon/CouponRequestDTO.java                                                                                                                                                                                                                                 
   - repositories/EventRepository.java                                                                                                                                                                                                                                   
   - repositories/CouponRepository.java                                                                                                                                                                                                                                  
   - repositories/AddressRepository.java                                                                                                                                                                                                                                 
   - Diretório repositories/                                                                                                                                                                                                                                             
   - Diretório domain/                                                                                                                                                                                                                                                   
   - mappers/EventMapper.java (substituído por EventJpaMapper)                                                                                                                                                                                                           
   - config/AWSConfig.java (movido para adapter)                                                                                                                                                                                                                         
 3. Limpar package structure:                                                                                                                                                                                                                                            
   - Verificar imports                                                                                                                                                                                                                                                   
   - Remover pacotes vazios                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                                         
 Verificação:                                                                                                                                                                                                                                                            
 - Build limpo sem warnings                                                                                                                                                                                                                                              
 - Todos os testes passam                                                                                                                                                                                                                                                
 - Nenhum código morto                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                         
 ---                                                                                                                                                                                                                                                                     
 FASE 6: Documentação e Refinamento (Dias 19-20)                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                                         
 Tarefas:                                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                         
 1. Atualizar CLAUDE.md:                                                                                                                                                                                                                                                 
   - Documentar nova estrutura hexagonal                                                                                                                                                                                                                                 
   - Explicar bounded contexts                                                                                                                                                                                                                                           
   - Atualizar comandos de build/test                                                                                                                                                                                                                                    
 2. Criar documentação de arquitetura:                                                                                                                                                                                                                                   
   - docs/architecture/hexagonal-overview.md                                                                                                                                                                                                                             
   - Diagramas (domain, ports, adapters)                                                                                                                                                                                                                                 
   - Decisões arquiteturais                                                                                                                                                                                                                                              
 3. Adicionar testes de arquitetura:                                                                                                                                                                                                                                     
   - ArchUnit: validar regras de dependência                                                                                                                                                                                                                             
   - Garantir domain não depende de frameworks                                                                                                                                                                                                                           
 4. Performance:                                                                                                                                                                                                                                                         
   - Profiling para identificar gargalos                                                                                                                                                                                                                                 
   - Otimizar mappers se necessário                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                         
 Verificação:                                                                                                                                                                                                                                                            
 - Documentação completa                                                                                                                                                                                                                                                 
 - ArchUnit tests passam                                                                                                                                                                                                                                                 
 - Performance dentro do esperado                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                         
 ---                                                                                                                                                                                                                                                                     
 Mapeamento de Classes                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                         
 Event Context                                                                                                                                                                                                                                                           
 ┌───────────────────────────────────┬──────────────────────────────────────────────────────────────┬───────────────────────────────────────────┐                                                                                                                        
 │           Código Atual            │                          Novo Local                          │                 Mudanças                  │                                                                                                                        
 ├───────────────────────────────────┼──────────────────────────────────────────────────────────────┼───────────────────────────────────────────┤                                                                                                                        
 │ domain/event/Event.java           │ event/domain/model/Event.java                                │ Remover JPA, adicionar métodos de negócio │                                                                                                                        
 ├───────────────────────────────────┼──────────────────────────────────────────────────────────────┼───────────────────────────────────────────┤                                                                                                                        
 │ domain/address/Address.java       │ event/domain/model/Location.java                             │ Converter para Value Object               │                                                                                                                        
 ├───────────────────────────────────┼──────────────────────────────────────────────────────────────┼───────────────────────────────────────────┤                                                                                                                        
 │ service/EventService.java         │ event/application/service/EventApplicationService.java       │ Implementar use cases, usar ports         │                                                                                                                        
 ├───────────────────────────────────┼──────────────────────────────────────────────────────────────┼───────────────────────────────────────────┤                                                                                                                        
 │ repositories/EventRepository.java │ event/adapter/out/persistence/SpringDataEventRepository.java │ Manter Spring Data JPA                    │                                                                                                                        
 ├───────────────────────────────────┼──────────────────────────────────────────────────────────────┼───────────────────────────────────────────┤                                                                                                                        
 │ controller/EventController.java   │ event/adapter/in/rest/EventRestController.java               │ Injetar use cases                         │                                                                                                                        
 ├───────────────────────────────────┼──────────────────────────────────────────────────────────────┼───────────────────────────────────────────┤                                                                                                                        
 │ domain/event/EventRequestDTO.java │ event/adapter/in/rest/dto/EventRequestDTO.java               │ Mover para REST adapter                   │                                                                                                                        
 ├───────────────────────────────────┼──────────────────────────────────────────────────────────────┼───────────────────────────────────────────┤                                                                                                                        
 │ config/AWSConfig.java             │ event/adapter/out/storage/S3Config.java                      │ Mover para adapter                        │                                                                                                                        
 └───────────────────────────────────┴──────────────────────────────────────────────────────────────┴───────────────────────────────────────────┘                                                                                                                        
 Coupon Context                                                                                                                                                                                                                                                          
 ┌────────────────────────────────────┬────────────────────────────────────────────────────────────────┬──────────────────────────────────────┐                                                                                                                          
 │            Código Atual            │                           Novo Local                           │               Mudanças               │                                                                                                                          
 ├────────────────────────────────────┼────────────────────────────────────────────────────────────────┼──────────────────────────────────────┤                                                                                                                          
 │ domain/coupon/Coupon.java          │ coupon/domain/model/Coupon.java                                │ Remover JPA, adicionar Value Objects │                                                                                                                          
 ├────────────────────────────────────┼────────────────────────────────────────────────────────────────┼──────────────────────────────────────┤                                                                                                                          
 │ service/CouponService.java         │ coupon/application/service/CouponApplicationService.java       │ Implementar use cases                │                                                                                                                          
 ├────────────────────────────────────┼────────────────────────────────────────────────────────────────┼──────────────────────────────────────┤                                                                                                                          
 │ repositories/CouponRepository.java │ coupon/adapter/out/persistence/SpringDataCouponRepository.java │ Manter Spring Data                   │                                                                                                                          
 ├────────────────────────────────────┼────────────────────────────────────────────────────────────────┼──────────────────────────────────────┤                                                                                                                          
 │ controller/CouponController.java   │ coupon/adapter/in/rest/CouponRestController.java               │ Injetar use cases                    │                                                                                                                          
 └────────────────────────────────────┴────────────────────────────────────────────────────────────────┴──────────────────────────────────────┘                                                                                                                          
 Shared                                                                                                                                                                                                                                                                  
 ┌────────────────────────────────────────────┬────────────────────────────────────────────────┐                                                                                                                                                                         
 │                Código Atual                │                   Novo Local                   │                                                                                                                                                                         
 ├────────────────────────────────────────────┼────────────────────────────────────────────────┤                                                                                                                                                                         
 │ exceptions/config/ApiExceptionHandler.java │ shared/adapter/web/GlobalExceptionHandler.java │                                                                                                                                                                         
 ├────────────────────────────────────────────┼────────────────────────────────────────────────┤                                                                                                                                                                         
 │ exceptions/config/ProblemDetails.java      │ shared/adapter/web/ProblemDetails.java         │                                                                                                                                                                         
 ├────────────────────────────────────────────┼────────────────────────────────────────────────┤                                                                                                                                                                         
 │ config/CorsConfig.java                     │ shared/adapter/web/CorsConfig.java             │                                                                                                                                                                         
 └────────────────────────────────────────────┴────────────────────────────────────────────────┘                                                                                                                                                                         
 Deletar após migração                                                                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                         
 - service/AddressService.java                                                                                                                                                                                                                                           
 - repositories/AddressRepository.java                                                                                                                                                                                                                                   
 - domain/address/Address.java                                                                                                                                                                                                                                           
 - Todo o package mappers/                                                                                                                                                                                                                                               
 - Todo o package repositories/                                                                                                                                                                                                                                          
 - Todo o package domain/                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                                         
 ---                                                                                                                                                                                                                                                                     
 Arquivos Críticos (Base para Implementação)                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                         
 1. service/EventService.java - Lógica de negócio atual, orquestração S3, padrões a replicar                                                                                                                                                                             
 2. domain/event/Event.java - Entidade atual, base para domain model puro                                                                                                                                                                                                
 3. repositories/EventRepository.java - Queries customizadas, projeções                                                                                                                                                                                                  
 4. controller/EventController.java - Endpoints REST, validações                                                                                                                                                                                                         
 5. domain/address/Address.java - Entidade a converter em Value Object                                                                                                                                                                                                   
                                                                                                                                                                                                                                                                         
 ---                                                                                                                                                                                                                                                                     
 Estratégia de Testes                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                         
 Testes durante migração                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                         
 1. Unit Tests:                                                                                                                                                                                                                                                          
   - Domain models (sem Spring)                                                                                                                                                                                                                                          
   - Application services (com mocks)                                                                                                                                                                                                                                    
   - Adapters isolados                                                                                                                                                                                                                                                   
 2. Integration Tests:                                                                                                                                                                                                                                                   
   - JPA adapters (com H2/TestContainers)                                                                                                                                                                                                                                
   - REST controllers (com MockMvc)                                                                                                                                                                                                                                      
   - Cross-context (EventExistenceAdapter)                                                                                                                                                                                                                               
 3. Parallel Testing:                                                                                                                                                                                                                                                    
   - Comparar respostas old vs new controllers                                                                                                                                                                                                                           
   - Validar equivalência funcional                                                                                                                                                                                                                                      
 4. Architecture Tests:                                                                                                                                                                                                                                                  
   - ArchUnit para validar dependency rules                                                                                                                                                                                                                              
   - Domain sem frameworks                                                                                                                                                                                                                                               
   - Ports não dependem de adapters                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                         
 Critérios de Sucesso                                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                         
 - Todos os testes existentes ainda passam                                                                                                                                                                                                                               
 - Cobertura de testes >= 80%                                                                                                                                                                                                                                            
 - ArchUnit tests passam                                                                                                                                                                                                                                                 
 - Nenhuma quebra de API REST                                                                                                                                                                                                                                            
 - Performance dentro de 5% do baseline                                                                                                                                                                                                                                  
 - Zero downtime em produção                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                         
 ---                                                                                                                                                                                                                                                                     
 Riscos e Mitigação                                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                                         
 Risco 1: Quebra de funcionalidade existente                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                                         
 Mitigação: Migração incremental, testes paralelos, feature flags                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                         
 Risco 2: Migração de banco (Address)                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                                         
 Mitigação: Zero-downtime strategy, backfill antes de drop, rollback plan                                                                                                                                                                                                
                                                                                                                                                                                                                                                                         
 Risco 3: Performance degradation                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                         
 Mitigação: Profiling, benchmarks, otimização de mappers                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                                         
 Risco 4: Curva de aprendizado                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                         
 Mitigação: Documentação detalhada, pair programming, code reviews                                                                                                                                                                                                       
                                                                                                                                                   
